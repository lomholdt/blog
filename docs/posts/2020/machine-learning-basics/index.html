<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" The machine learning journey &middot;  wunderwuzzi blog" />
  
  <meta property="og:site_name" content="wunderwuzzi blog" />
  <meta property="og:url" content="https://embracethered.com/blog/posts/2020/machine-learning-basics/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2020-08-29T21:02:16-07:00" />
  
  <meta property="og:article:tag" content="machine learning" />
  
  <meta property="og:article:tag" content="red" />
  
  

  <title>
     The machine learning journey &middot;  wunderwuzzi blog
  </title>

  <link rel="stylesheet" href="https://embracethered.com/blog/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/main.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/github.css" />
  
  <link rel="stylesheet" href="https://embracethered.com/blog/fonts/cachedfonts.css" type="text/css">
  <link rel="shortcut icon" href="https://embracethered.com/blog/images/favicon.ico" />
  <link rel="apple-touch-icon" href="https://embracethered.com/blog/images/apple-touch-icon.png" />
  

</head>
<body>
    <header class="global-header"  style="background-image:url( /images/bg.jpg )">
    <section class="header-text">
      <h1><a href="https://embracethered.com/blog/">wunderwuzzi blog</a></h1>
      
      <div class="tag-line" style="min-width:fit-content; font-weight: 400;">
        Embrace the Red
        <br><a style="color: greenyellow; font-weight:300;text-decoration: underline; " href="https://www.amazon.com/Cybersecurity-Attacks-Strategies-practical-penetration-ebook/dp/B0822G9PTM">Cybersecurity Attacks - Red Team Strategies</a> 
      </div>
      
      <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="https://embracethered.com/blog/" class="btn-header btn-back hidden-xs">
        <i class="fa fa-angle-left" aria-hidden="true"></i>
        &nbsp;Home
      </a>
      
    
      <a href="/blog/index.xml" class="btn-header btn-subscribe hidden-xs">
        <i class="fa fa-rss" aria-hidden="true"></i>
        &nbsp;Subscribe
      </a>
    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">The machine learning journey</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2020-08-29T21:02:16-07:00">
          Aug 29, 2020
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/machine-learning">#machine learning</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/red">#red</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>This year I have been busy studying machine learning and artificial intelligence.</p>
<p>To come up with good attacks, I figured it is time to learn the fundamentals and start using software, tools and algorithms. My goal was to build a couple of end to end machine learning systems from scratch.</p>
<p>This post describes my studying approach, materials, courses, and learnings. I thought to share this, in case there are others who are interested to get started in this space but don&rsquo;t how and where.</p>
<p>Further posts will dive into AI/ML fundamentals and <strong>adversarial techniques</strong> with practical examples - for instance how to attack models, how to backdoor one, and so forth.</p>
<p>Along the way I even found a security bug, which I will share details about once fixed by Microsoft.</p>
<h2 id="my-ai-background">My AI background</h2>
<p>In college I took some <strong>AI</strong> and <strong>Fuzzy Logic</strong> classes, hence I am familiar with some concepts around artificial intelligence. Although I basically had zero practical experience when it comes to machine learning, especially with current software such as Tensorflow, Keras, PyTorch or fast.ai. None of those even existed when I first learned about AI.</p>
<p>Until a few months back, my last (and only) project in the AI space was building a &ldquo;self-driving car parking simulator&rdquo; using fuzzy logic - and that was in 2003 using <strong>Matlab</strong>.</p>
<p>Interestingly, a peer student from back then ended up building autonomous sailboats, and his <a href="http://www.roboat.at/en/home/">Roboat</a> won the autonomous world sailing championships numerous times.</p>
<p>At that time I got sidetracked with security engineering. :)</p>
<p>So, it seemed a good idea to step back and start from scratch when it comes to learning about AI and machine learning.</p>
<h2 id="the-motivating-factor">The motivating factor</h2>
<p>I&rsquo;m a curious professional security engineer, mentor, builder/breaker/tester. The motivating factor for me was to learn more about testing AI-powered systems, and more importantly hopefully inspire others to do the same.</p>
<p>When I managed the <strong>Azure Data Attack Team</strong> at Microsoft&rsquo;s Cloud+AI division, we regularly were tasked to attack Azure Machine Learning service offering. Although the work focused on application and network side of things, rather than attacking models themselves. Microsoft is top-notch in the AI space when it comes to security by the way. There is even a Trustworthy Machine Learning Group that does research and publishes information regularly. I recommend reading their <a href="https://docs.microsoft.com/en-us/security/engineering/failure-modes-in-machine-learning">published material</a>. Also, interesting to know that Facebook has a seperate dedicated <a href="https://www.zdnet.com/article/cybersecurity-how-facebooks-red-team-is-pushing-boundaries-to-keep-your-data-safe/">AI Red Team</a>. This is totally an exciting space to be involved.</p>
<p>Naturally with the general AI/ML hype the last few years and news about adversaries misusing them, it seems good to expand skillset and knowledge in regard to specific AI/ML testing skills (in addition to typically end-to-end red teaming scenarios).</p>
<h3 id="study-material-so-far">Study material so far</h3>
<p>Below is a list of core materials I have used for studying:</p>
<ul>
<li><a href="https://www.coursera.org/learn/machine-learning">Machine Learning</a>, Andrew Ng</li>
<li><a href="https://deeplearning.ai">deeplearning.ai</a>, Andrew Ng</li>
<li><a href="https://arxiv.org/pdf/1911.07658.pdf">Hacking Neural Networks - A short introduction</a>, Michael Kissner</li>
<li><a href="https://www.coursera.org/professional-certificates/tensorflow-in-practice">Tensorflow in practice</a>, Laurence Moroney</li>
<li><a href="https://www.fast.ai/">fast.ai</a>, Jeremy Howard, Fast AI</li>
<li><a href="https://www.amazon.com/Machine-Learning-Security-Protecting-Algorithms-ebook/dp/B079C7LKKY">Machine Learning and Security</a>,  Clarence Chio, David Freeman</li>
<li><a href="https://docs.microsoft.com/en-us/security/engineering/failure-modes-in-machine-learning">Failure modes in Machine Learning</a>, Microsoft</li>
</ul>
<p>In addition I watched countless YouTube videos, including Lex Fridman, Ariel Herbert-Voss, Fei Fei Li and many others.</p>
<p>When learning something new, I typically write the most important learnings and concepts down separately in a OneNote - <em>in my own words</em>. This helps me to internalize concepts. Additionally, I often create a <code>glossary</code> with key words and phrases to help me remember things:</p>
<p><img src="/blog/images/2020/ml-translation.jpg" alt="Machine Learning that I can understand"></p>
<p>When I hear <code>derivative</code>, I just think <code>slope</code> for instance. Or, my favorite, <code>Dropout</code> is like putting the neural network on drugs by dropping random cells. Yes, that is actually a technique used to improve machine learning outcomes!</p>
<h2 id="projects">Projects</h2>
<p>Taking courses or reading books *<em>without actually</em> building something is a waste of time in my opinion. When starting, I already had two projects in mind to apply machine learning to.</p>
<ol>
<li>
<p><strong>Mood prediction</strong> Here is the hypothesis: Given a set of 20 features per day (such as distance run/biked, hours of sleep, playing violin, reading, number of social interactions, money spent, and so forth), can I predict my own mood? For that I have been collecting detailed data in an Excel sheet since the beginning of the year.</p>
</li>
<li>
<p><strong>Husky AI</strong> The idea for the second project came as soon as I started taking Andrew Ng&rsquo;s course and worked on recognizing cats vs dogs. Going forward I will use this project to study and research adversarial machine learning techniques.</p>
</li>
</ol>
<p><img src="/blog/images/2020/huskyornot.jpg" alt="Husky AI"></p>
<p>Now, let me share the ML specific material that taught me how to build something like &ldquo;Husky AI&rdquo;.</p>
<h2 id="machine-learning-by-andrew-ng">Machine Learning by Andrew Ng</h2>
<p>I started by taking the <a href="https://www.coursera.org/learn/machine-learning">Machine Learning course by Andrew Ng</a> on Coursera.</p>
<p>The course was great I thought. It starts by teaching the basic math concepts with plenty of intuition - which was helpful for me. The material builds from the ground up and is very engaging and informative. You basically implement machine learning and gradient descent yourself with a scientific programming language called <a href="https://www.gnu.org/software/octave/">Octave</a>. The course is at least 7 years old now, which is probably the reason for that choice (compared to more popular Python these days).</p>
<p>A lot of time is spent on understanding &ldquo;gradient descent&rdquo; and how logistic regression works. At that point I also started working on own AI experiments to play around with the algorithms and hyper-parameters to get better intuition around the algorithms. What I really liked was that we implemented the algorithm from scratch, rather then using frameworks.</p>
<p>Neural Networks are covered, but mostly in equal portion to other machine learning techniques. To me this was the most foundational course I took, really helping to get a good intuition what the math is doing.</p>
<p>There is also an entire sections and deep dives into <code>Anomaly Detection</code>, <code>Recommender Systems</code> and <code>Collaborative Filtering</code>.</p>
<p>Overall, I really thought this course was put together very well.</p>
<h2 id="deeplearningai">deeplearning.ai</h2>
<p>After finishing the Machine Learning course, I focused on taking the <a href="https://deeplearning.ai">deeplearning.ai</a> classes.</p>
<p>It covers some of the same content as the previous class but is more modernized when it comes to tooling and nomenclature. The biggest difference is that it focuses solely on Neural Networks. The course covers machine learning aspects from image processing, natural language processing, as well as audio.</p>
<p>You will learn a lot about the building blocks of neural networks, choosing testing parameters (hyper-parameters). It goes into details around activation functions such as ReLu, Softmax, tanh,&hellip;  so it&rsquo;s overall quite detailed and helps deepen the concepts.</p>
<p>I found it very interesting to look at the middle (also called hidden layers) of neural networks and inspect their results. This gives great insights into what happens - or maybe it allows one to ask more questions. Certainly, something that you should do with your own models - it&rsquo;s quite fascinating.</p>
<p>Language wise the course focuses on Python (Jupyter Notebooks, numpy, some Tensorflow/Keras,&hellip;).</p>
<p>The course also dives into RNNs (recurrent neural nets), and ResNets (residual networks) which I had heard of before but never knew what they meant.</p>
<p>The most difficult part to understand were sequence models. For that I still need to build a separate project from scratch to play around more to understand it.</p>
<p>Overall, this is a polished and modernized version of the Machine Learning course - with some overlapping content but also a lot of new material which makes it a good follow up course.</p>
<h2 id="tensorflow-in-practice-laurence-moroney">TensorFlow in Practice, Laurence Moroney</h2>
<p>This course was much more hands-on and with the knowledge I had previously acquired it went quite smoothly. It also became clear that ML courses seem to fall back to some basic datasets and examples (cats vs dogs, digits,&hellip;) when learning about machine learning and neural networks.</p>
<p>I liked the excercises around recognizing hand gestures, which was a novel one.</p>
<p>Even though TensorFlow and Keras are the systems I know best at this point, I&rsquo;m not quite sure I like TensorFlow that much. It doesn&rsquo;t seem very intuitive and there are odd breaking changes from TensorFlow 1.0 to 2.0 which reflects Google&rsquo;s lack of being able to maintain backwards compatibility (they are kind of known for terminating products and services out of the blue).</p>
<p>A simple example is when it comes to metrics measurement when training. There is a dictionary with the key <code>acc</code> in TensorFlow 1 and that key was renamed to <code>accuracy</code> in version 2. Now all the scripts and examples, including those from Google themselves through errors and are not working as expected.</p>
<p>The course is high quality in the beginning, but somewhere towards the middle it drops slightly with instructions for exercises - I believe they are still upgrading/improving it over time.</p>
<p>Using <code>Keras</code> seems more straight forward (then pure TensorFlow) and <a href="https://colab.research.google.com">Google&rsquo;s Collab platform</a> works great and it even includes free GPU based machines.</p>
<h2 id="fastai-by-jeremy-howard">fast.ai by Jeremy Howard</h2>
<p>After building my own models and experimenting for a while, I got curious about <code>fast.ai</code>. So far, I have not had the time to go through majority of the material. The library and API seem really intuitive and focused on productivity. I will spend more time the next few weeks learning how to use it. I&rsquo;m not yet sure if I will port <code>Husky AI</code> to fast.ai or PyTorch.</p>
<h2 id="hacking-neural-networks-by-michael-kissner">Hacking Neural Networks by Michael Kissner</h2>
<p>Oh, wow - this post is getting very long. But I still want to highlight the paper <a href="https://arxiv.org/pdf/1911.07658.pdf">Hacking Neural Networks - A short introduction</a>. It also comes with a Github repo that helps you do exercises to learn more about adversarial techniques towards ML models, and even <strong>has a super cool example on how to exploit a buffer overflow in the GPU to overwrite model information</strong>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Without having taken the Machine Learning or deeplearning.ai courses I would have not understood a lot of things in the paper of Michael Kissner for instance. There are other videos I am watching on YouTube now, which make a lot more sense as well - now that I know some of the basics. It was time well spent I think to go threw the material and work on all the excercises, as well as building my own models to complement and put the learned information to good use. It was fantastic.</p>
<h2 id="going-forward">Going forward</h2>
<p>My next post will describe &ldquo;Husky AI&rdquo; in more detail and how it was built and put into production. And then we go into the details of performing attacks on the model. The first attack will be bruteforcing from the outside, then backdooring and updating the model directly - which might be a useful technique to be aware of when performing internal red teaming operations.</p>
<p>If you found this interesting or have questions, feel free to send a DM to <a href="https://twitter.com/wunderwuzzi23">@wunderwuzzi23</a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://www.coursera.org/learn/machine-learning">Machine Learning</a>, Andrew Ng</li>
<li><a href="https://deeplearning.ai">deeplearning.ai</a>, Andrew Ng</li>
<li><a href="https://arxiv.org/pdf/1911.07658.pdf">Hacking Neural Networks - A short introduction</a>, Michael Kissner</li>
<li><a href="https://www.coursera.org/professional-certificates/tensorflow-in-practice">TensorFlow in practice</a>, Laurence Moroney</li>
<li><a href="https://www.fast.ai/">fast.ai</a>, Jeremy Howard, Fast AI</li>
<li><a href="https://www.amazon.com/Machine-Learning-Security-Protecting-Algorithms-ebook/dp/B079C7LKKY">Machine Learning and Security</a></li>
<li><a href="https://docs.microsoft.com/en-us/security/engineering/failure-modes-in-machine-learning">Failure modes in Machine Learning</a>, Microsoft</li>
<li><a href="https://wuzzi.net/huskyai">Husky AI</a></li>
<li><a href="http://www.roboat.at/en/home/">Autonomous Sailboat - Roboat</a></li>
<li><a href="http://people.ischool.berkeley.edu/~tygar/papers/Machine_Learning_Security/asiaccs06.pdf">Can machine learning be secure?</a></li>
<li><a href="https://www.zdnet.com/article/cybersecurity-how-facebooks-red-team-is-pushing-boundaries-to-keep-your-data-safe/">Facebook AI Red Team</a></li>
<li><a href="https://www.gnu.org/software/octave/">Octave</a></li>
</ul>

  </section>
  <footer>
    
    
    
    <footer></footer><hr/>
    
    <ul class="pager">
      
      <li class="previous"><a href="https://embracethered.com/blog/posts/2020/husky-ai-walkthrough/"><span aria-hidden="true">&larr;</span> Older</a></li>
      
      
      <li class="author-contact">
        <a href="mailto:security@wunderwuzzi.net">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          &nbsp;Contact me
        </a>
     </li>

      
      
      <li class="next"><a href="https://embracethered.com/blog/posts/2020/shadowbunny-bsides-singapore-virtual-machines/">Newer <span aria-hidden="true">&rarr;</span></a></li>
      
    </ul>
  </footer>
</article>
</main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
     
     (c) WUNDERWUZZI 2020
     <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>
 
     <div style="font-size:small;font-style: italic;color:crimson">
    Disclaimer: Penetration testing requires authorization from proper stakeholders. Information on this blog is provided for research and educational purposes to advance understanding of attacks and countermeasures to help secure the Internet. 
    </div>
    </div>
</footer>
  <script src="https://embracethered.com/blog/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  



<script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//wuzzi.net/anamato/inc/";
    _paq.push(['setTrackerUrl', u+'rts.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'rts.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://wuzzi.net/anamato/inc/rts.php?idsite=1&amp;rec=1" style="border:0;" alt="" />
  
</body>
</html>

